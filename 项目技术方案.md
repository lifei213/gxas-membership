# 广西自动化学会会员管理系统 - 总体方案与技术路线说明书

## 1. 项目概述
本项目旨在为广西自动化学会开发一套现代化的会员管理系统。系统集成了会员档案管理、AR增强现实会员卡体验、学术交流论坛以及数据可视化分析等功能。采用“云端数据库 + 多端访问”的架构，既支持Web端访问，也支持Windows桌面客户端运行。

## 2. 总体设计方案

### 2.1 系统架构
本系统采用 **混合架构 (Hybrid Architecture)** 设计：
- **数据层 (Data Layer)**：基于云端的 Supabase (PostgreSQL) 数据库，负责存储会员信息、论坛帖子、评论及系统配置。
- **应用层 (Application Layer)**：
    - **Web端**：基于标准 Web 技术 (HTML5/CSS3/JavaScript) 构建的单页应用 (SPA) 体验。
    - **桌面端**：使用 Electron 框架将 Web 应用封装为 Windows 本地可执行程序 (.exe)，提供更流畅的桌面体验。
- **服务层 (Service Layer)**：利用 Supabase 提供的 Auth (认证)、Database (数据库)、Realtime (实时订阅) 等 Serverless 服务。

### 2.2 功能模块划分
1.  **用户认证模块**：
    - 支持邮箱/密码注册与登录。
    - 包含密码重置、自动登录维持会话功能。
    - 权限区分：普通会员、管理员。
2.  **会员中心 (Dashboard)**：
    - **个人档案**：查看及编辑会员基本信息、职称、工作单位等。
    - **数据可视化**：使用 ECharts 展示会员画像分析。
    - **系统精灵**：可拖动的 AI 助手悬浮球，提供交互入口。
3.  **AR 会员卡体验**：
    - 自动生成唯一的 11 位数字会员 ID。
    - 生成专属二维码，支持移动端扫码预览。
    - 数字化卡片展示，包含姓名、ID及动态视觉效果。
4.  **学术交流论坛**：
    - 板块分类（学术动态、技术问答等）。
    - 实时发帖、评论互动。
    - 阅读量统计与热度排行。

## 3. 技术路线 (Technical Route)

### 3.1 前端技术栈 (Client-Side)
- **核心语言**：
    - **HTML5**：构建语义化的页面结构。
    - **CSS3**：实现响应式布局、动画效果（如 AR 卡片光效）及多主题切换（浅色/深色/学会定制色）。
    - **Vanilla JavaScript (ES6+)**：采用原生 JS 进行逻辑开发，不依赖大型框架（如 Vue/React），保证代码轻量且易于维护。
- **第三方库**：
    - `@supabase/supabase-js`：与后端数据库进行通讯。
    - `ECharts`：用于生成会员数据统计图表。
    - `SheetJS (xlsx)`：用于导出会员名单为 Excel 文件。
    - `QRCode.js`：前端实时生成会员卡二维码。

### 3.2 后端与数据库技术 (Server-Side & Database)
- **后端平台**：**Supabase** (开源 Firebase 替代方案)。
- **数据库引擎**：**PostgreSQL** (关系型数据库)。
- **核心技术点**：
    - **Row Level Security (RLS)**：通过数据库策略严格控制数据访问权限（例如：用户只能修改自己的资料，所有人可读取论坛帖子）。
    - **Database Triggers (触发器)**：使用 PL/pgSQL 编写存储过程，实现新用户注册时自动生成 11 位随机会员 ID、自动创建档案条目。
    - **Realtime Subscriptions**：利用 WebSocket 实现论坛新消息的实时推送。

### 3.3 桌面端封装技术 (Desktop Wrapper)
- **框架**：**Electron**。
    - 利用 Chromium 渲染引擎和 Node.js 运行时，将 Web 页面打包为桌面应用。
- **打包工具**：**electron-packager**。
    - 将源代码、依赖库及运行时环境打包为独立的 Windows 文件夹/安装包，无需用户安装环境即可运行。

### 3.4 安全性设计
- **传输加密**：全站强制 HTTPS / SSL 加密传输。
- **身份验证**：基于 JWT (JSON Web Token) 的无状态认证机制。
- **数据隔离**：通过 PostgreSQL 的 RLS 策略，确保后端接口层面的数据安全，防止越权访问。

## 4. 关键实现流程

### 4.1 会员 ID 自动生成机制
1.  用户注册成功，触发数据库 `INSERT` 事件。
2.  PostgreSQL 触发器执行 `generate_member_code()` 函数。
3.  函数生成 11 位随机数，并校验唯一性，写入 `profiles` 表。
4.  前端通过 API 获取该 ID 并渲染至 AR 会员卡。

### 4.2 桌面端与 Web 端代码复用
项目采用“一套代码，多端运行”的策略。通过 Electron 的 `BrowserWindow` 加载本地 HTML 文件，同时注入 Node.js 模块（如 `shell`）以实现调用系统默认浏览器打开外部链接等原生功能，最大化开发效率。

---
**文档生成日期**：2025-12-17
**版本**：1.0
